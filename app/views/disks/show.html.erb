<p style="color: green"><%= notice %></p>

<h1 class="container">Detalles del disco</h1>
<br>

<div id="disk-details-" class="container">
  <article style="background-color: #f9efdb; padding: 2rem;">

    <h4 class="container"><%= @disk.title %></h4>

    <!-- Grid de 2 columnas: datos a la izquierda, imagen a la derecha -->
    <div class="grid">

      <!-- Columna 1: Datos del disco -->
      <div>
        <table class="table-invisible">

        <hr style="border-color: #b92621; border-top: 3px solid #b92621;">

        <thead>
        </thead>

            <tbody>
                <tr>
                        <td class="tg-0lax">
                        <span style="color: #1343a0;">• </span> Artista
                        </td>
                        <td class="tg-0lax"><%= @disk.artist %></td>
                </tr>

                <tr>
                        <td class="tg-0lax">
                        <span style="color: #1343a0;">• </span> Año
                        </td>
                        <td class="tg-0lax"><%= @disk.year %></td>
                </tr>

                <tr>
                        <td class="tg-0lax">
                        <span style="color: #1343a0;">• </span> Géneros
                        </td>
                        <td class="tg-0lax">
                            <% @disk.genres.each do |genre| %>
                            <span style="color: #1343a0;">• </span><%= genre.genre_name %><br>
                            <% end %>
                        </td>
                </tr>

                <tr>
                        <td class="tg-0lax">
                        <span style="color: #1343a0;">• </span> Estado
                        </td>
                        <td class="tg-0lax"><%= @disk.state %></td>
                </tr>

                <tr>
                        <td class="tg-0lax">
                        <span style="color: #1343a0;">• </span> Formato
                        </td>
                        <td class="tg-0lax"><%= @disk.format %></td>
                </tr>

                <tr>
                  <td class="tg-0lax">
                  <span style="color: #1343a0;">• </span> Stock
                  </td>
                  <% if @disk.stock == 1 %>
                    <td class="tg-0lax" style="color: #b92621;">  Último disponible</td>
                  <% else %>
                    <td class="tg-0lax">  <%= @disk.stock %> disponibles</td>
                  <% end %>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td class="tg-0lax">
                      <br>
                    <span style="color: #1343a0;">• </span> <%= number_to_currency(@disk.price, :locale => :es) %>
                    </td>
                </tr>
            </tfoot>
        </table>
      </div>

      <!-- Columna 2: Portada del disco -->
       <div style="display: flex; justify-content: center; align-items: center;">
         <% if @disk.cover.attached? %>
          <%= image_tag @disk.cover,
                 style: "width: 400px; height: 400px; border-radius: 8px; box-shadow: 0 8px 16px rgba(0,0,0,0.1);" %>
         <% else %>
           <div class="pico-background-red-100" style="width: 400px; height: 400px; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
             <span style="color: #b92621;">Sin portada</span>
           </div>
         <% end %>
       </div>
    </div>

  <!-- Descripción del disco -->
  <div style="margin-top: 1rem; padding: 1rem; background-color: #fff; border-radius: 8px;">
    <h5 style="color: #1343a0;">Descripción</h5>
    <p><%= @disk.description %></p>
  </div>

  <br>

<% if @disk.state == "Usado" && @disk.audio_sample.attached? %>
  <div class="container">
    <h5 style="color: #b92621;">Muestra de audio </h5>
      <!-- Reproductor de audio -->
      <audio controls style="width: 100%; height: 50px;">
        <source src="<%= rails_blob_url(@disk.audio_sample) %>"
                type="<%= @disk.audio_sample.content_type %>">
        Tu navegador no soporta el elemento de audio.
      </audio>
  </div>
  <br>
<% elsif @disk.state == "Usado" %>
  <div class="no-audio-message">
    <p style="color: #b92621;">
      • Este disco no tiene muestra de audio disponible.
    </p>
  </div>
<% end %>

<br>
    <details name="imagenes" closed>
      <summary style="color: #1343a0; font-size: 24px;"><strong>▿ Imágenes</strong></summary>
          <div id="disks-responsive-images" class="container">
            <div class="disks-grid" style="display: flex;flex-wrap: nowrap;justify-content: flex-start; gap: 2rem;">
                  <div style="display: flex; justify-content: center; align-items: left;">
                    <% if @disk.cover.attached? %>
                        <%= link_to image_tag(@disk.cover,
                                class: "disk-tile",
                                style: "width: 200px; height: 200px; border-radius: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);"),
                            disk_path(@disk),
                            class: "disk-link",
                            data: { tooltip: "#{@disk.title} - #{@disk.artist}", placement: "bottom" }
                             %>
                    <% else %>
                      <div class="pico-background-red-100" style="width: 200px; height: 200px; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                        <span style="color: #b92621;">Sin portada</span>
                      </div>
                    <% end %>
                    <% if @disk.images.attached? %>
                      <% @disk.images.each do |image| %>
                        <%= image_tag image,
                               style: "width: 400px; height: 400px; border-radius: 8px; box-shadow: 0 8px 16px rgba(0,0,0,0.1);" %>
                      <% end %>
                    <% end %>
                  </div>
            </div>
          </div>
        <br>
    </details>

    <br>
    <details name="recomendaciones" closed>
      <summary style="color: #1343a0; font-size: 24px;"><strong>▿ Discos relacionados</strong></summary>
          <div id="disks-responsive" class="container">
            <div class="disks-grid" style="display: flex;flex-wrap: nowrap;justify-content: flex-start; gap: 2rem;">
              <% @recommended_disks.each do |disk| %>
                  <div style="display: flex; justify-content: center; align-items: left;">
                    <% if disk.cover.attached? %>
                        <%= link_to image_tag(disk.cover,
                                class: "disk-tile",
                                style: "width: 200px; height: 200px; border-radius: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);"),
                            disk_path(disk),
                            class: "disk-link",
                            data: { tooltip: "#{disk.title} - #{disk.artist}", placement: "bottom" }
                             %>
                    <% else %>
                      <div class="pico-background-red-100" style="width: 200px; height: 200px; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                        <span style="color: #b92621;">Sin portada</span>
                      </div>
                    <% end %>
                  </div>
              <% end %>
            </div>
          </div>
        <br>
    </details>

    <hr>

 </article>
</div>

<br>
<div>
  <p class="container">
    <%= link_to "<< Volver", disks_path, style: "color: #1343a0; font-family: monospace; font-size: 18px;" %>
  </p>
</div>
